<template>
    <div ref="terminal"></div>
</template>

<script>
    // 引入css
    import "xterm/dist/xterm.css";
    import "xterm/dist/addons/fullscreen/fullscreen.css";

    import { Terminal } from "xterm";
    // 自适应插件
    import * as fit from "xterm/lib/addons/fit/fit";
    // 全屏插件
    import * as fullscreen from "xterm/lib/addons/fullscreen/fullscreen";
    // web链接插件
    import * as webLinks from "xterm/lib/addons/webLinks/webLinks";
    // websocket插件
    import * as attach from "xterm/lib/addons/attach/attach";

    export default {
        name: "Index",
        created() {
            // 安装插件
            Terminal.applyAddon(attach);
            Terminal.applyAddon(fit);
            Terminal.applyAddon(fullscreen);
            Terminal.applyAddon(webLinks);

            // 初始化终端
            const terminal = new Terminal();
            // 打开websocket
            const ws = new WebSocket("ws://127.0.0.1:8081/exec?id=229dab4f6eaf");
            // 绑定到dom上
            terminal.open(this.$refs.terminal);
            // 加载插件
            terminal.fit();
            terminal.toggleFullScreen();
            terminal.webLinksInit();
            terminal.attach(ws);
        }
    };
</script>
